<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>FetchBlockFeeHistory | open-gas-price</title><meta name="description" content="Documentation for open-gas-price"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script async src="../assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">open-gas-price</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><ul class="tsd-breadcrumb"><li><a href="../modules.html">open-gas-price</a></li><li><a href="FetchBlockFeeHistory.html">FetchBlockFeeHistory</a></li></ul><h1>Namespace FetchBlockFeeHistory</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><section class="tsd-panel-group tsd-index-group"><h2>Index</h2><section class="tsd-panel tsd-index-panel"><div class="tsd-index-content"><section class="tsd-index-section "><h3>Type aliases</h3><ul class="tsd-index-list"><li class="tsd-kind-type-alias tsd-parent-kind-namespace tsd-has-type-parameter"><a href="FetchBlockFeeHistory.html#Block" class="tsd-kind-icon">Block</a></li><li class="tsd-kind-type-alias tsd-parent-kind-namespace"><a href="FetchBlockFeeHistory.html#EthFeeHistoryResponse" class="tsd-kind-icon">Eth<wbr/>Fee<wbr/>History<wbr/>Response</a></li></ul></section><section class="tsd-index-section "><h3>Functions</h3><ul class="tsd-index-list"><li class="tsd-kind-function tsd-parent-kind-namespace tsd-has-type-parameter"><a href="FetchBlockFeeHistory.html#default" class="tsd-kind-icon">default</a></li></ul></section></div></section></section><section class="tsd-panel-group tsd-member-group "><h2>Type aliases</h2><section class="tsd-panel tsd-member tsd-kind-type-alias tsd-parent-kind-namespace tsd-has-type-parameter"><a id="Block" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Block<a href="#Block" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><div class="tsd-signature tsd-kind-icon">Block<span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">Percentile</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-symbol">{ </span>baseFeePerGas<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">BN</span><span class="tsd-signature-symbol">; </span>gasUsedRatio<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">; </span>number<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">BN</span><span class="tsd-signature-symbol">; </span>priorityFeesByPercentile<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Record</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">Percentile</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">BN</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol"> }</span></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/manifoldfinance/open-gas-price/blob/4897ef1/src/fetchBlockFeeHistory.ts#L52">fetchBlockFeeHistory.ts:52</a></li></ul></aside><div class="tsd-comment tsd-typography"><dl class="tsd-comment-tags"><dt>property</dt><dd><p>number - The number of the block, as a BN.</p>
</dd><dt>property</dt><dd><p>baseFeePerGas - The base fee per gas for the block in WEI, as a BN.</p>
</dd><dt>property</dt><dd><p>gasUsedRatio - A number between 0 and 1 that represents the ratio between the gas paid
for the block and its set gas limit.</p>
</dd><dt>property</dt><dd><p>priorityFeesByPercentile - The priority fees paid for the transactions in the block
that occurred at particular levels at which those transactions contributed to the overall gas
used for the block, indexed by those percentiles. (See docs for {@link fetchBlockFeeHistory} for more
on how this works.)</p>
</dd></dl></div><h4 class="tsd-type-parameters-title">Type parameters</h4><ul class="tsd-type-parameters"><li><h4>Percentile<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">number</span></h4></li></ul><div class="tsd-type-declaration"><h4>Type declaration</h4><ul class="tsd-parameters"><li class="tsd-parameter"><h5>base<wbr/>Fee<wbr/>Per<wbr/>Gas<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">BN</span></h5></li><li class="tsd-parameter"><h5>gas<wbr/>Used<wbr/>Ratio<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">number</span></h5></li><li class="tsd-parameter"><h5>number<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">BN</span></h5></li><li class="tsd-parameter"><h5>priority<wbr/>Fees<wbr/>By<wbr/>Percentile<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Record</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">Percentile</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">BN</span><span class="tsd-signature-symbol">&gt;</span></h5></li></ul></div></section><section class="tsd-panel tsd-member tsd-kind-type-alias tsd-parent-kind-namespace"><a id="EthFeeHistoryResponse" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Eth<wbr/>Fee<wbr/>History<wbr/>Response<a href="#EthFeeHistoryResponse" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><div class="tsd-signature tsd-kind-icon">Eth<wbr/>Fee<wbr/>History<wbr/>Response<span class="tsd-signature-symbol">:</span> <span class="tsd-signature-symbol">{ </span>baseFeePerGas<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol">; </span>gasUsedRatio<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol">; </span>oldestBlock<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">; </span>reward<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol"> }</span></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/manifoldfinance/open-gas-price/blob/4897ef1/src/fetchBlockFeeHistory.ts#L32">fetchBlockFeeHistory.ts:32</a></li></ul></aside><div class="tsd-comment tsd-typography"><dl class="tsd-comment-tags"><dt>property</dt><dd><p>oldestBlock - The id of the oldest block (in hex format) in the range of blocks
requested.</p>
</dd><dt>property</dt><dd><p>baseFeePerGas - Base fee per gas for each block in the range of blocks requested.</p>
</dd><dt>property</dt><dd><p>gasUsedRatio - A number between 0 and 1 that represents the gas used vs. gas limit for
each block in the range of blocks requested.</p>
</dd><dt>property</dt><dd><p>reward - The priority fee at the percentiles requested for each block in the range of
blocks requested.</p>
</dd></dl></div><div class="tsd-type-declaration"><h4>Type declaration</h4><ul class="tsd-parameters"><li class="tsd-parameter"><h5>base<wbr/>Fee<wbr/>Per<wbr/>Gas<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">[]</span></h5></li><li class="tsd-parameter"><h5>gas<wbr/>Used<wbr/>Ratio<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">[]</span></h5></li><li class="tsd-parameter"><h5>oldest<wbr/>Block<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span></h5></li><li class="tsd-parameter"><h5><span class="tsd-flag ts-flagOptional">Optional</span> reward<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol">[]</span></h5></li></ul></div></section></section><section class="tsd-panel-group tsd-member-group "><h2>Functions</h2><section class="tsd-panel tsd-member tsd-kind-function tsd-parent-kind-namespace tsd-has-type-parameter"><a id="default" class="tsd-anchor"></a><h3 class="tsd-anchor-link">default<a href="#default" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-function tsd-parent-kind-namespace tsd-has-type-parameter"><li class="tsd-signature tsd-kind-icon">default<span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">Percentile</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">(</span>args<span class="tsd-signature-symbol">: </span><span class="tsd-signature-symbol">{ </span>endBlock<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">BN</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type">&quot;latest&quot;</span><span class="tsd-signature-symbol">; </span>ethQuery<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">; </span>numberOfBlocks<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">; </span>percentiles<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-symbol">readonly </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">Percentile</span><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol"> }</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="FetchBlockFeeHistory.html#Block" class="tsd-signature-type" data-tsd-kind="Type alias">Block</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">Percentile</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/manifoldfinance/open-gas-price/blob/4897ef1/src/fetchBlockFeeHistory.ts#L91">fetchBlockFeeHistory.ts:91</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Uses <code>eth_feeHistory</code> (an EIP-1559 feature) to obtain information about gas fees from a range of
blocks that have occurred recently on a network.</p>
</div><div><p>To learn more, see these resources:</p>
<ul>
<li><a href="https://infura.io/docs/ethereum#operation/eth_feeHistory">https://infura.io/docs/ethereum#operation/eth_feeHistory</a></li>
<li><a href="https://github.com/zsfelfoldi/feehistory/blob/main/docs/feeHistory.md">https://github.com/zsfelfoldi/feehistory/blob/main/docs/feeHistory.md</a></li>
<li><a href="https://github.com/ethereum/go-ethereum/blob/57a3fab8a75eeb9c2f4fab770b73b51b9fe672c5/eth/gasprice/feehistory.go#L180">https://github.com/ethereum/go-ethereum/blob/57a3fab8a75eeb9c2f4fab770b73b51b9fe672c5/eth/gasprice/feehistory.go#L180</a></li>
<li><a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-1559.md">https://github.com/ethereum/EIPs/blob/master/EIPS/eip-1559.md</a></li>
<li><a href="https://gas-api.metaswap.codefi.network/testFeeHistory">https://gas-api.metaswap.codefi.network/testFeeHistory</a></li>
</ul>
</div></div><h4 class="tsd-type-parameters-title">Type parameters</h4><ul class="tsd-type-parameters"><li><h4>Percentile<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">number</span></h4></li></ul><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>args: <span class="tsd-signature-symbol">{ </span>endBlock<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">BN</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type">&quot;latest&quot;</span><span class="tsd-signature-symbol">; </span>ethQuery<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">; </span>numberOfBlocks<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">; </span>percentiles<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-symbol">readonly </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">Percentile</span><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol"> }</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The arguments to this function.</p>
</div></div><ul class="tsd-parameters"><li class="tsd-parameter"><h5><span class="tsd-flag ts-flagOptional">Optional</span> end<wbr/>Block<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">BN</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type">&quot;latest&quot;</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The desired end of the requested block range. Can be &quot;latest&quot; if you want
to start from the latest successful block or the number of a known past block.</p>
</div></div></li><li class="tsd-parameter"><h5>eth<wbr/>Query<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">any</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>An EthQuery instance that wraps a provider for the network in question.</p>
</div></div></li><li class="tsd-parameter"><h5>number<wbr/>Of<wbr/>Blocks<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">number</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>How many total blocks to fetch. Note that if this is more than 1024,
multiple calls to <code>eth_feeHistory</code> will be made.</p>
</div></div></li><li class="tsd-parameter"><h5><span class="tsd-flag ts-flagOptional">Optional</span> percentiles<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-symbol">readonly </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">Percentile</span><span class="tsd-signature-symbol">[]</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>A set of numbers between 1 and 100 which will dictate how
<code>priorityFeesByPercentile</code> in each returned block will be formed. When Ethereum runs the
<code>eth_feeHistory</code> method, for each block it is considering, it will first sort all transactions by
the priority fee. It will then go through each transaction and add the total amount of gas paid
for that transaction to a bucket which maxes out at the total gas used for the whole block. As
the bucket fills, it will cross percentages which correspond to the percentiles specified here,
and the priority fees of the first transactions which cause it to reach those percentages will be
recorded. Hence, <code>priorityFeesByPercentile</code> represents the priority fees of transactions at key
gas used contribution levels, where earlier levels have smaller contributions and later levels
have higher contributions.</p>
</div></div></li></ul></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="FetchBlockFeeHistory.html#Block" class="tsd-signature-type" data-tsd-kind="Type alias">Block</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">Percentile</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol">&gt;</span></h4><div><p>The list of blocks and their fee data, sorted from oldest to newest.</p>
</div></li></ul></section></section></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class=""><a href="../modules.html">Exports</a></li><li class=" tsd-kind-namespace"><a href="CalculateBusyThreshold.html">Calculate<wbr/>Busy<wbr/>Threshold</a></li><li class=" tsd-kind-namespace"><a href="DetermineNetworkStatusInfo.html">Determine<wbr/>Network<wbr/>Status<wbr/>Info</a></li><li class="current tsd-kind-namespace"><a href="FetchBlockFeeHistory.html">Fetch<wbr/>Block<wbr/>Fee<wbr/>History</a></li><li class=" tsd-kind-namespace"><a href="FetchBusyThreshold.html">Fetch<wbr/>Busy<wbr/>Threshold</a></li><li class=" tsd-kind-namespace"><a href="GasUtil.html">Gas<wbr/>Util</a></li><li class=" tsd-kind-namespace"><a href="Transaction.html">Transaction</a></li><li class=" tsd-kind-namespace"><a href="Version.html">Version</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-type-alias tsd-parent-kind-namespace tsd-has-type-parameter"><a href="FetchBlockFeeHistory.html#Block" class="tsd-kind-icon">Block</a></li><li class="tsd-kind-type-alias tsd-parent-kind-namespace"><a href="FetchBlockFeeHistory.html#EthFeeHistoryResponse" class="tsd-kind-icon">Eth<wbr/>Fee<wbr/>History<wbr/>Response</a></li><li class="tsd-kind-function tsd-parent-kind-namespace tsd-has-type-parameter"><a href="FetchBlockFeeHistory.html#default" class="tsd-kind-icon">default</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="../assets/main.js"></script></body></html>